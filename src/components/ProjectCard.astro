---
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import { tv } from "tailwind-variants";

const styles = tv({
  slots: {
    root: [
      "relative block cursor-pointer rounded-lg bg-opacity-5 p-4 outline-none ring-1 ring-inset ring-opacity-15",
      "transition duration-300 ease-in-out",
      "hover:bg-opacity-15 focus-visible:ring-opacity-50 active:ring-opacity-30",
    ],
    wrapper: "mb-1 flex items-center gap-2",
    logo: "size-6 rounded-full shadow ring-1 ring-black/10",
    title: "text-xl font-semibold leading-normal after:absolute after:inset-0 after:z-10",
    description: "mb-2 font-serif opacity-75",
    date: "font-mono text-sm first-letter:uppercase",
  },
});

const formatter = new Intl.DateTimeFormat(Astro.currentLocale, { year: "numeric", month: "short" });

type Props = {
  entry: CollectionEntry<"projects">;
};

const { entry } = Astro.props;
---

<div
  class={styles().root()}
  style={{
    background: `rgba(${entry.data.rgb}, var(--tw-bg-opacity))`,
    "--tw-ring-color": `rgba(${entry.data.rgb}, var(--tw-ring-opacity))`,
  }}
>
  <div class={styles().wrapper()}>
    <Image src={entry.data.logo} alt={entry.data.title} draggable="false" width={24} height={24} class={styles().logo()} />
    <a href={entry.data.href} target="_blank" rel="noopener noreferrer" class={styles().title()}>
      {entry.data.title}
    </a>
  </div>
  <p class={styles().description()}>
    {entry.data.description}
  </p>
  <p class={styles().date()} style={{ color: `rgb(${entry.data.rgb})` }}>
    {
      entry.data.dateEnd
        ? formatter.formatRange(entry.data.dateStart, entry.data.dateEnd)
        : formatter.format(entry.data.dateStart)
    }
  </p>
</div>
